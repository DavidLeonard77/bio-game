<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script type="text/javascript">
    /*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011â€“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
</script>

<script type="text/javascript">
    $(function() {

        var count = 0;
        var correct = 0;
        var answermap = {
            'product1': 'vendor1',
            'product2': 'vendor2',
            'product3': 'vendor4',
            'product4': 'vendor7',
            'product5': 'vendor6',
            'product6': 'vendor3',
            'product7': 'vendor5',
            'product8': 'vendor8'
        };

        function answerIsCorrect(product, vendor) {
            return answermap[product] === vendor ? true : false;
        }

        function createCookie(name, value, days) {
            var expires = '';
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = '; expires=' + date.toGMTString();
            }
            document.cookie = name + '=' + value + expires + '; path=/';
        }

        function readCookie(name) {
            var nameEQ = name + '=';
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1, c.length);
                }
                if (c.indexOf(nameEQ) == 0) {
                    return c.substring(nameEQ.length, c.length);
                }
            }
            return null;
        }

        function initGame () {

            createCookie('biocompare-challenge', '0', 10);
            if (readCookie('biocompare-challenge')) {

                $('#game-container').show();
                $('#cookie-alert').hide();

                // Draggable
                $('.draggable').draggable({
                    revert: 'invalid',
                    snap: '.droppable',
                    snapMode: 'inner',
                    snapTolerance: 52
                });

                // Droppable
                $('.droppable').droppable({
                    accept: '.draggable',
                    classes: {
                        'ui-droppable-active': 'ui-state-active',
                        'ui-droppable-hover': 'ui-state-hover'
                    },
                    drop: function(event, ui) {

                        count++;

                        $(ui.draggable)
                            .draggable('disable');
                        $(this)
                            .droppable('disable')
                            .addClass('dropped');

                        var productId = $(this)[0].id;
                        var vendorId = ui.draggable[0].id;

                        if (answerIsCorrect( productId, vendorId )) {
                            correct++;
                        }

                        createCookie('biocompare-challenge', correct, 10);

                    }
                });

            } else {
                $('#cookie-alert').show();
                $('#game-container').hide();
            }

        }

        initGame();

    });
</script>
